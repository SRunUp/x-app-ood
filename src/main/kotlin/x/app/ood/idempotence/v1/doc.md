### 接口幂等性

**背景**：超时重试需要接口幂等性的支持

**需求**

**幂等号：针对同⼀个接⼝，多次发起同⼀个业务请求，必须保证业务只执⾏⼀次**

#### 功能性需求

- 接口方生成幂等号，并且跟随接口请求，将幂等号传递给接口实现方。
- 按照约定，从HTTP Header或者接⼝参数中，解析出幂等号，然后通过幂等号查询幂等框架。
  - 如果幂等号已经存在，说明业务已经执⾏或正在执⾏，则直接返回；
  - 如果幂等号不存在，说明业务没有执⾏过，则记录幂等号，继续执⾏业务

#### 非功能性需求

易用性：接入简单方便

性能：减少对业务接口请求本身的响应时间的影响

容错：出错后，不影响正常接口处理



#### 设计

正常处理流程

业务代码异常

业务系统宕机处理

幂等框架异常处理



### 实现

实现⽣成幂等号的功能

实现存储、查询、删除幂等号的功能 - 通过 Redis 实现